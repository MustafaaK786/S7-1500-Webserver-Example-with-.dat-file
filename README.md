## Disclaimer

### Ownership and Attribution
This repository contains demo material that was not created by me. The code consists of:
- Example material originally from Siemens
- Modified and enhanced versions generated by Claude AI (Anthropic)

I do not claim ownership, copyright, or originality for any content in this repository. All intellectual property rights belong to their respective owners (Siemens and Anthropic).

### Usage Restrictions
This code is provided **strictly for demonstration and educational purposes only**. It is:
- NOT intended for use in live or production systems
- NOT designed with security features necessary for real-world implementation
- NOT officially supported by Siemens or Anthropic

### Limitation of Liability
I take absolutely no responsibility for any consequences resulting from the use, modification, or distribution of this code. By downloading, copying, or using any part of this repository, you acknowledge that:
1. You do so entirely at your own risk
2. No warranty of any kind is provided
3. The code may contain errors, vulnerabilities, or other issues
4. Neither I nor the original creators can be held liable for any damages, losses, or other liabilities

### Industrial Control Systems Warning
The demo materials in this repository interface with Programmable Logic Controllers (PLCs), which are often used in industrial control systems. Unauthorized or improper use of such interfaces with actual industrial systems can lead to:
- Equipment damage
- Production downtime
- Safety hazards
- Legal consequences

Always obtain proper authorization and follow all applicable safety standards when working with industrial control systems.

### License
This repository is shared for informational purposes only and does not grant any license rights beyond what is required for viewing the demonstration.

------------------------------------------------------------------------------------------------------------------------------------------------------

# Understanding the S7-PLC AJAX Variable Interface
This document explains how the PLC web interface works in simple terms for someone with beginner HTML and JavaScript experience.

## Overview
This Web interface connects to a S7-1200/1500 Siemens S7 PLC (Programmable Logic Controller). It allows you to:
1. View PLC variable values in real-time
2. Change these values directly from your browser
3. Monitor communication between your browser and the PLC (with the debug panel)

## The Three Files in this Package

1. **plc-ajax-with-debug.html** - The main web interface with debug capabilities
2. **variable_values.dat** - A file that provides updated PLC values (served by the PLC)
3. **explanation.md** - This explanation document

## How it Works: Step by Step

### 1. Initial Page Load

When you Navigate to _http://[PLC-IP]/awp/[ApplicationName]/[Default_HTML_Page]_ in your browser, e.g. __http://192.168.0.2/awp/AJAX/plc-ajax-with-debug.html__
For the fully working application with the ".dat" functionality, use the two files: plc-ajax-fixedAll, and read_variables.dat. therefore, open __http://192.168.0.2/awp/AJAX/plc-ajax-fixedAll.html__

- The browser requests the page from the PLC web server
- The PLC processes special tags like `<!-- AWP_In_Variable Name='"MyVariables".boolValue' -->` which tell the PLC which variables to expose
- The PLC replaces placeholders like `:="MyVariables".boolValue:` with actual values from its memory
- The page is sent to your browser with current values already filled in

### 2. Periodic Updates (Polling)

The page automatically refreshes values every second by:

- Using JavaScript's `setTimeout()` function to run code at regular intervals
- Sending AJAX requests to fetch the latest values without reloading the whole page
- Parsing the response from variable_values.dat and updating the display

### 3. Writing Values to the PLC

When you change a value through the interface:

- JavaScript detects the change (through events like "onclick" or "onchange")
- It creates a special URL query string (like `?"MyVariables".boolValue=true&0.123456789`)
- It sends this query to the PLC using AJAX
- The PLC receives the request, updates its internal variable, and sends back confirmation
- The webpage shows a success message and updates the displayed value

## Key Technical Concepts

### Server-Side Includes (SSI)

Patterns like `:="MyVariables".boolValue:` are server-side includes. The PLC replaces these with actual values before sending the page to your browser. This technology lets the webpage show real-time PLC data.

### AJAX (Asynchronous JavaScript and XML)

AJAX allows the webpage to send/receive data from the server without reloading the entire page. This creates a smoother user experience and reduces network traffic.

### Browser Compatibility Code

The code includes workarounds for different browsers (IE, Firefox, Opera). This is important for industrial applications that might run on older systems.

### HTTP Requests

The code uses GET requests with parameters in the URL:
- To read values: Requests the .dat file
- To write values: Sends a request with the variable name and new value as parameters

## The Debug Panel

The debug panel shows you exactly what's happening behind the scenes:

- **REQUEST entries**: Show what's being sent to the PLC
- **RESPONSE entries**: Show what comes back from the PLC
- **ERROR entries**: Display problems that occurred
- **PARSE entries**: Show how the raw data is interpreted
- **UPDATE entries**: Indicate when values are refreshed

Each entry includes a timestamp so you can track the sequence of events.

## variable_values.dat File

This file is generated by the PLC and contains the current values of your variables in this format:
```
:="MyVariables".boolValue: :="MyVariables".intValue: :="MyVariables".stringValue:
```

For Testing the following can be used - example, if your boolean is true, integer is 42, and string is "Hello", the file would contain:
```
true 42 Hello
```

## Common Issues and Troubleshooting

1. **404 Error for variable_values.dat**
   - Cause: The .dat file doesn't exist on the PLC
   - Solution: Create the file with the proper format and place it in the same directory

2. **Variables not updating**
   - Cause: Incorrect parsing of values or communication issues
   - Solution: Check the debug panel to see what responses are coming back

3. **Values reset after changes**
   - Cause: The polling is overwriting your changes with old values
   - Solution: Make sure the .dat file is being updated with your changes

## Adapting the Code

To use this with different PLC variables:

1. Change the `AWP_In_Variable` tags at the top to include your variable names
2. Update the initial value assignments in the `Start()` function
3. Modify the HTML interface elements and their associated functions
4. Update the parsing logic in `UpdateCallback()` if your .dat file format differs

## Security Considerations

This example uses simple GET requests which are not secure for critical systems. In a production environment, consider:

- Adding authentication
- Using HTTPS
- Implementing input validation
- Adding confirmation for critical operations

## Conclusion

This interface demonstrates basic web communication with a Siemens S7 PLC. The code handles:
- Reading values from the PLC
- Displaying them in a user-friendly interface
- Sending user changes back to the PLC
- Debugging the communication process

With the debug panel, you can better understand how web-based PLC interfaces work and troubleshoot any issues that arise.


